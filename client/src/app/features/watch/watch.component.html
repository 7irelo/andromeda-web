<div class="watch-page">
  <div class="watch-header">
    <h1>Watch</h1>
  </div>

  <div class="upload-card card">
    <div class="upload-title">Upload Video</div>
    <div class="upload-fields">
      <input
        type="text"
        placeholder="Title (optional)"
        [(ngModel)]="uploadTitle"
        class="upload-input"
      />
      <textarea
        placeholder="Description (optional)"
        [(ngModel)]="uploadDescription"
        class="upload-input upload-textarea"
      ></textarea>
      <div class="upload-actions">
        <button mat-stroked-button (click)="videoInput.click()" [disabled]="uploading">
          <mat-icon>upload_file</mat-icon>
          {{ selectedVideo ? selectedVideo.name : 'Choose video' }}
        </button>
        <button mat-flat-button color="primary" (click)="uploadVideo()" [disabled]="!selectedVideo || uploading">
          <mat-icon>cloud_upload</mat-icon>
          {{ uploading ? 'Uploading...' : 'Upload' }}
        </button>
      </div>
    </div>
    <input #videoInput type="file" hidden accept="video/*" (change)="onVideoSelected($event)" />
  </div>

  <div *ngIf="loading" class="loading-center"><mat-spinner diameter="40"></mat-spinner></div>

  <div class="video-grid" *ngIf="!loading">
    <a class="video-card" *ngFor="let v of videos" [routerLink]="'/watch/' + v.id">
      <div class="thumbnail-wrap">
        <img [src]="v.thumbnail || 'assets/default-thumb.png'" [alt]="v.title" class="thumbnail" />
        <span class="duration">{{ formatDuration(v.duration) }}</span>
      </div>
      <div class="video-info">
        <div class="video-title font-medium">{{ v.title }}</div>
        <div class="text-secondary text-xs">
          {{ v.uploader.full_name }} Â· {{ v.views_count | number }} views
        </div>
      </div>
    </a>
  </div>

  <div *ngIf="!loading && videos.length === 0" class="empty-state">
    <mat-icon>play_circle_outline</mat-icon>
    <p>No videos yet</p>
  </div>
</div>
